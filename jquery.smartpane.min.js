/**
 * jQuery SmartPane v 0.3.1
 * Licensed under the MIT license.
 * Copyright 2013 Takayuki Irokawa
 */
(function(b){function g(){h&&(a.marginTop=d.fixedHeader?b(d.fixedHeader).outerHeight():0,a.marginBottom=d.fixedFooter?b(d.fixedFooter).outerHeight():0)}var f=[],a={},d={},h=!1,e;if(void 0===b.support.fixedPosition||!1!==b.support.fixedPosition)b.smartpane=function(a,k){this.$self=b(a);for(this.$parent=this.$self.parent();0===this.$parent.innerHeight();)this.$parent=this.$parent.parent();this.type=k;var d=this.$parent.css("position");"relative"!==d&&"absolute"!==d&&this.$parent.css("position","relative");this.init()},b.smartpane.prototype={init:function(){this.$self.css({position:"relative",top:"0px",left:"0px",width:this.$self.innerWidth()});this.position="top";var a=this.$self.offset();this.containerTop=a.top-parseInt(this.$self.css("margin-top"));this.containerLeft=a.left-parseInt(this.$self.css("margin-left"));this.offsetTop=0},update:function(){this.height=this.$self.outerHeight();this.containerBottom=this.containerTop+this.$parent.innerHeight();var c,d=this.type;if(this.height<a.height||"both"===d&&"resize"===b.smartpane.event.type)d="top";switch(d){case "top":a.top<=this.containerTop?c="top":this.containerBottom<=a.top+this.height?c="bottom":(c="fixed",this.offsetTop=a.top-this.containerTop);break;case "bottom":a.bottom<=this.containerTop+this.height?c="top":this.containerBottom<=a.bottom?c="bottom":(c="fixed",this.offsetTop=a.bottom-this.height-this.containerTop);break;case "both":a.top<=this.containerTop?c="top":this.containerBottom<=a.bottom?c="bottom":"up"===a.scroll&&a.top<this.containerTop+this.offsetTop?(c="fixed",this.offsetTop=a.top-this.containerTop):"down"===a.scroll&&this.containerTop+this.offsetTop+this.height<a.bottom?(c="fixed",this.offsetTop=a.bottom-this.height-this.containerTop):c="relative"}if(c!==this.position||"fixed"===c){switch(c){case "fixed":this.$self.css({position:"fixed",top:this.containerTop+this.offsetTop-a.scrollTop+"px",left:this.containerLeft-a.left+"px"});break;case "bottom":this.$self.css({position:"relative",top:(this.offsetTop=this.containerBottom-this.containerTop-this.height)+"px",left:"0px"});break;case "top":this.$self.css({position:"relative",top:(this.offsetTop=0)+"px",left:"0px"});break;case "relative":this.$self.css({position:"relative",top:this.offsetTop+"px",left:"0px"})}this.position=c}}},b.extend(b.smartpane,{init:function(){h=!0;b.smartpane.onresize.call(this,b.Event("init"))},onresize:function(){g();b.each(f,b.smartpane.prototype.init);b.smartpane.onscroll.apply(this,arguments)},onscroll:function(c){b.smartpane.event=c;c=b(window);a.scrollTop=c.scrollTop();a.top=a.scrollTop+a.marginTop;a.left=c.scrollLeft();a.height=c.height()-a.marginTop-a.marginBottom;a.bottom=a.top+a.height;a.scrollDist=a.scrollTop-e;a.scroll=e<a.scrollTop?"down":e>a.scrollTop?"up":"none";e=a.scrollTop;b.each(f,b.smartpane.prototype.update)},options:function(a){b.extend(d,a);g()}}),b.fn.smartpane=function(a){return this.each(function(){var d=b(this);void 0==d.data("smartpane")&&(d.data("smartpane",a),f.push(new b.smartpane(this,a)))})},b(function(){var a=b(window);e=a.scrollTop();a.resize(b.smartpane.onresize);a.scroll(b.smartpane.onscroll);b("[data-smartpane]").each(function(){f.push(new b.smartpane(this,b(this).data("smartpane")))});b.smartpane.init.apply(window)})})(jQuery);