/**
 * jQuery SmartPane
 * Licensed under the MIT license.
 * Copyright 2013 Takayuki Irokawa
 */
(function(b){var f=[],e,d=0;if(void 0===b.support.fixedPosition||!1!==b.support.fixedPosition)b.smartpane=function(a,c){this.$self=b(a);for(this.$parent=this.$self.parent();0===this.$parent.innerHeight();)this.$parent=this.$parent.parent();this.type=c;var d=this.$parent.css("position");"relative"!==d&&"absolute"!==d&&this.$parent.css("position","relative");this.init()},b.smartpane.prototype={init:function(){this.$self.css({position:"relative",top:"0px",left:"0px",width:this.$self.innerWidth()});this.position="top";var a=this.$self.offset();this.containerTop=a.top-parseInt(this.$self.css("margin-top"));this.containerLeft=a.left-parseInt(this.$self.css("margin-left"));this.offsetTop=0},update:function(a){this.height=this.$self.outerHeight();this.containerBottom=this.containerTop+this.$parent.innerHeight();var c,e=this.type;if(this.height<a.height||"both"===e&&"resize"===b.smartpane.event.type)e="top";switch(e){case "top":a.top<=this.containerTop-d?c="top":this.containerBottom<=a.top+this.height+d?c="bottom":(c="fixed",this.offsetTop=a.top-this.containerTop+d);break;case "bottom":a.bottom<=this.containerTop+this.height?c="top":this.containerBottom<=a.bottom?c="bottom":(c="fixed",this.offsetTop=a.bottom-this.height-this.containerTop);break;case "both":a.top<=this.containerTop-d?c="top":this.containerBottom<=a.bottom?c="bottom":"up"===a.scroll&&a.top<this.containerTop+this.offsetTop-d?(c="fixed",this.offsetTop=a.top-this.containerTop+d):"down"===a.scroll&&this.containerTop+this.offsetTop+this.height<a.bottom?(c="fixed",this.offsetTop=a.bottom-this.height-this.containerTop):c="relative"}if(c!==this.position||"fixed"===c){switch(c){case "fixed":this.$self.css({position:"fixed",top:this.containerTop+this.offsetTop-a.top+"px",left:this.containerLeft-a.left+"px"});break;case "bottom":this.$self.css({position:"relative",top:(this.offsetTop=this.containerBottom-this.containerTop-this.height)+"px",left:"0px"});break;case "top":this.$self.css({position:"relative",top:(this.offsetTop=0)+"px",left:"0px"});break;case "relative":this.$self.css({position:"relative",top:this.offsetTop+"px",left:"0px"})}this.position=c}}},b.extend(b.smartpane,{init:function(){b.smartpane.onresize.call(this,b.Event("init"))},onresize:function(){b.each(f,b.smartpane.prototype.init);b.smartpane.onscroll.apply(this,arguments)},onscroll:function(a){b.smartpane.event=a;a=b(window);a={top:a.scrollTop(),left:a.scrollLeft(),height:a.height()};a.bottom=a.top+a.height;a.scrollDist=a.top-e;a.scroll=e<a.top?"down":e>a.top?"up":"none";e=a.top;b.each(f,b.smartpane.prototype.update,[a])},fixedHeader:function(a){d=b(a).outerHeight()}}),b.fn.smartpane=function(a){return this.each(function(){var c=b(this);void 0==c.data("smartpane")&&(c.data("smartpane",a),f.push(new b.smartpane(this,a)))})},b(function(){var a=b(window);e=a.scrollTop();a.resize(b.smartpane.onresize);a.scroll(b.smartpane.onscroll);b("[data-smartpane]").each(function(){f.push(new b.smartpane(this,b(this).data("smartpane")))});b.smartpane.init.apply(window)})})(jQuery);